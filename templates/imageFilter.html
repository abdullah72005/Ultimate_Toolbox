{% extends "layout.html" %}

{% block title %}
    Image Filter 
{% endblock %}

{% block style %}<link href="../static/stylesheets/photo.css" rel="stylesheet">{% endblock %}


{% block main %}
    <form action="/image/filter" method="post" enctype="multipart/form-data" id="filterForm">
        <h2 style="display: none;" id="fileName">{{ fileName }}</h2>
        <div class="topTabs">
            <button type="button" onclick="showBlock('filter')">
                Filter
            </button>
            <button type="button" onclick="showBlock('edit')">
               Edit
            </button> 
        </div> 
        <input id="operationChoice" name="operation" value="filter" style="display: none;">
        <div class="leftBoxes" id = "filterBlock" style="display: block;">
            <div id="outputChoice" name="choice" value="choice" onchange="toggleSlider()">
                {% for choice in filters %}
                    <button value="{{ choice }}" name="choice">
                        <img src="" alt="">
                        {{ choice }}
                    </button>
                {% endfor %}
            </div>
            <label for="slider" id="sliderLabel" style="display: none;">Select a value:</label>
            <input type="range" class="form-control-range" id="slider" name="slider" min="0" max="5" value="5" style="display: none;">
            <output for="slider" id="sliderValue" class="mt-2 badge badge-primary" style="display: none;">50</output>
        </div>
        <div class="leftBoxes" id="editBlock" style="display: none;">
            <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.js"></script>
            <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.12/cropper.min.css" rel="stylesheet">
            <div class="selectContainer">
                <div class="selectBox" onclick="toggleMenu()" id="aspectRatio">Free</div>
                    <div id="selectOptions" class="selectOptions">
                        <div class="cropRatio" onclick="changeRatio('free')">Free</div>
                        <div class="cropRatio" onclick="changeRatio('16/9')">16:9</div>
                        <div class="cropRatio" onclick="changeRatio('4/3')">4:3</div>
                        <div class="cropRatio" onclick="changeRatio('1/1')">1:1</div>
                    </div>
                </div>
            <button type="button" id="rotateClockwise">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24">
                    <rect width="24" height="24" fill="none" />
                    <path fill="none" stroke="#32174d" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 4.55a8 8 0 0 1 6 14.9M15 15v5h5M5.63 7.16v.01M4.06 11v.01m.57 4.09v.01m2.53 3.26v.01M11 19.94v.01" />
                </svg>                
            </button>
            <button type="button" id="rotateCounterclockwise">
                <img src="" alt="">
                Rotate Counterclockwise
            </button>
            <button type="button" id="flipHorizontal">
                <img src="" alt="">
                Flip Horizontal
            </button>
            <button type="button" id="flipVertical">
                <img src="" alt="">
                Flip Vertical
            </button>
            <button type="button" id="dragCrop">
                <img src="" alt="">
                Crop Drag Mode
            </button>
            <button type="button" id="dragMove">
                <img src="" alt="">
                Move Drag Mode
            </button>
            <button type="button" id="dragNone">
                <img src="" alt="">
                None Drag Mode
            </button>    
            <input type="hidden" name="cropped_image" id="croppedImage">
            <input type="hidden" name="isCropped" id="isCropped" value="{{ isCropped }}">
        </div>

        <div id="imageContainer" class="theImg">
            <img id="img" src="{{ imgPath }}" alt="Uploaded Image">
        </div>

        <div class="bottomBoxes">
            <button type="submit" class="btn btn-primary" name="button" value="apply" id="applyFilter" style="display: block;" value="original">Original</button>
            <button type="submit" class="btn btn-primary" name="button" value="apply" id="applyCrop" style="display: none;" onclick="applyCrop1()">Apply changes</button>
            <button type="submit" class="btn btn-primary" name="choice" value="download" id="downloadFilter" style="display: block;">Download</button>
            <button type="button" class="btn btn-primary" name="button" value="download" id="downloadCrop" style="display: none;">Download</button>
        </div>

    </form>

<script src="../static/image.js"> </script>
{% endblock %}
